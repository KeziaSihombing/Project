<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CatCare - Profil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <?php require_once "navbar.php"?>
    <header class="text-center py-3">
        <svg class="logo-svg" width="238" height="60" viewBox="0 0 238 60" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M50.3027 19.7736C56.3417 18.7015 60.256 14.4549 60.0998 11.2374C59.8489 6.04291 56.0614 3.43237 47.8963 3.39943H47.7913C47.3526 3.40015 46.9291 3.24039 46.6022 2.95082C46.2752 2.66125 46.0678 2.26229 46.0198 1.83057C45.9969 1.62625 46.0162 1.41944 46.0767 1.22277C46.1372 1.0261 46.2375 0.843693 46.3715 0.68668C46.5055 0.529668 46.6705 0.401343 46.8563 0.30954C47.0421 0.217736 47.2448 0.164378 47.4521 0.152723L47.7491 0.134982C50.1785 -0.0170883 52.864 -0.105796 54.3129 0.233828C60.3545 1.65188 63.7081 5.25848 63.9897 11.0524C64.2137 15.6601 60.7513 20.1639 55.8784 23.7249L55.7363 23.8263C56.6792 25.4602 57.283 27.2859 57.5475 29.3033C58.4665 35.1428 57.6115 38.7748 58.2668 41.18C58.9235 43.5865 61.9097 44.9058 63.0886 47.5936C64.2675 50.2814 64.0486 51.4587 63.703 53.575C63.4991 54.8305 63.0391 56.6646 62.3232 59.0774C62.2441 59.3438 62.08 59.5776 61.8555 59.7439C61.631 59.9102 61.3581 60 61.0777 60H56.7629C56.0461 60 55.4649 59.4247 55.4649 58.715V58.0687C55.4649 57.8988 55.499 57.7305 55.5651 57.5737C55.6312 57.4169 55.728 57.2746 55.85 57.1551C55.9721 57.0356 56.1168 56.9413 56.2759 56.8775C56.435 56.8138 56.6053 56.7819 56.7769 56.7837C57.3598 56.7913 57.8564 56.6393 58.2668 56.3275C59.3049 55.5418 59.3907 55.1033 59.3907 53.575C59.3907 52.5562 59.0161 51.531 58.2668 50.4994C55.2589 48.563 52.7437 47.0499 50.5241 45.9373C50.2954 48.1702 49.8462 50.2003 49.1763 52.0277C48.4723 53.9489 47.249 56.393 45.5065 59.36C45.3928 59.555 45.2292 59.7169 45.0321 59.8293C44.835 59.9416 44.6114 60.0005 44.384 60H40.9689C40.2649 60 39.6889 59.4449 39.6723 58.748L39.6569 58.165C39.6479 57.8288 39.7722 57.5025 40.0034 57.2561C40.2346 57.0097 40.5541 56.8629 40.8934 56.8471L42.679 56.7634C43.2064 56.7381 43.6659 56.3997 43.8413 55.9068C44.4326 54.2441 44.6758 52.6102 44.5709 51.005C44.4514 49.1946 43.843 46.7251 42.7456 43.5967C38.1888 43.5561 28.9446 45.514 26.816 45.6889C26.3142 45.7303 25.7988 45.7278 25.2697 45.6813C24.8416 47.0132 24.5739 48.3906 24.4723 49.7847C24.3409 51.4718 24.3289 54.438 24.4365 58.6833C24.4407 58.8547 24.4103 59.0252 24.347 59.1848C24.2837 59.3444 24.1888 59.4898 24.0678 59.6125C23.9469 59.7352 23.8023 59.8327 23.6427 59.8992C23.4832 59.9658 23.3117 60.0001 23.1385 60H19.5917C18.8749 60 18.2938 59.4247 18.2938 58.715V57.833C18.2938 57.1233 18.8749 56.548 19.5917 56.548H20.1382C20.3409 56.548 20.5405 56.4996 20.7202 56.4068C20.8999 56.3141 21.0543 56.1798 21.1704 56.0154C21.2865 55.851 21.3608 55.6612 21.387 55.4623C21.4132 55.2634 21.3906 55.0611 21.3209 54.8727C20.6496 53.072 20.1269 51.2204 19.7581 49.3361L15.4931 59.2206C15.2883 59.6933 14.8186 60 14.2989 60H9.58848C8.87168 60 8.28928 59.4247 8.28928 58.715V58.0586C8.28928 57.4351 8.74112 56.9016 9.36063 56.7939L11.6032 56.3997C11.8848 56.3491 12.1434 56.2096 12.3366 55.9993C13.2471 55.0066 13.8342 53.7702 14.0979 52.29C14.7482 48.6391 15.1603 48.2437 14.0979 44.7334C13.7523 43.5865 11.2154 42.4688 9.59232 37.3884C8.5521 34.1366 7.62965 28.6127 6.82496 20.8165C6.796 20.5354 6.67421 20.2715 6.47844 20.0657C6.28268 19.86 6.02386 19.7239 5.74208 19.6786L3.24864 19.2794C2.86464 19.2173 2.528 18.9879 2.33216 18.6546L0.3584 15.2787L0.30464 15.1937C0.111364 14.9314 0.00493839 14.6162 0 14.2915C0 14.0431 0.0652801 13.7867 0.19584 13.5222C0.265813 13.3812 0.3584 13.257 0.4736 13.1497L3.0528 10.7508C3.232 10.5822 3.36128 10.3668 3.42272 10.1298L3.56864 9.55574C3.6992 9.04504 3.98592 8.58502 4.38784 8.24033C5.16352 7.57882 5.7361 7.13529 6.1056 6.90972C6.5664 6.62923 7.52298 6.29299 8.97536 5.90098C8.23808 4.87958 7.8336 3.98574 7.76192 3.21948C7.65312 2.07008 7.56096 0.932084 8.03072 0.88773C8.3456 0.859006 9.14218 1.71567 10.4205 3.45772C10.3206 1.25608 10.5455 0.283673 11.095 0.540503C11.6446 0.797333 12.852 2.28129 14.7174 4.99236L16.5376 7.04531C17.4217 8.04245 18.0721 9.22083 18.4422 10.496C19.3621 13.6642 20.2368 15.9448 21.0662 17.3379C22.5497 19.8243 24.3686 22.886 30.2797 22.4323C36.1894 21.9799 38.1773 20.795 42.1145 20.1817C44.1299 19.8781 46.1604 19.6831 48.1971 19.5975C48.9037 19.5645 49.6117 19.6237 50.3027 19.7736Z" fill="#F59245"/>
            <path d="M65.6989 29.92C65.6989 27.1467 66.2989 24.68 67.4989 22.52C68.6989 20.3333 70.3656 18.64 72.4989 17.44C74.6589 16.2133 77.0989 15.6 79.8189 15.6C83.1522 15.6 86.0056 16.48 88.3789 18.24C90.7522 20 92.3389 22.4 93.1389 25.44H85.6189C85.0589 24.2667 84.2589 23.3733 83.2189 22.76C82.2056 22.1467 81.0456 21.84 79.7389 21.84C77.6322 21.84 75.9256 22.5733 74.6189 24.04C73.3122 25.5067 72.6589 27.4667 72.6589 29.92C72.6589 32.3733 73.3122 34.3333 74.6189 35.8C75.9256 37.2667 77.6322 38 79.7389 38C81.0456 38 82.2056 37.6933 83.2189 37.08C84.2589 36.4667 85.0589 35.5733 85.6189 34.4H93.1389C92.3389 37.44 90.7522 39.84 88.3789 41.6C86.0056 43.3333 83.1522 44.2 79.8189 44.2C77.0989 44.2 74.6589 43.6 72.4989 42.4C70.3656 41.1733 68.6989 39.48 67.4989 37.32C66.2989 35.16 65.6989 32.6933 65.6989 29.92ZM95.9677 32.8C95.9677 30.5067 96.3943 28.4933 97.2477 26.76C98.1277 25.0267 99.3143 23.6933 100.808 22.76C102.301 21.8267 103.968 21.36 105.808 21.36C107.381 21.36 108.754 21.68 109.928 22.32C111.128 22.96 112.048 23.8 112.688 24.84V21.68H119.528V44H112.688V40.84C112.021 41.88 111.088 42.72 109.888 43.36C108.714 44 107.341 44.32 105.768 44.32C103.954 44.32 102.301 43.8533 100.808 42.92C99.3143 41.96 98.1277 40.6133 97.2477 38.88C96.3943 37.12 95.9677 35.0933 95.9677 32.8ZM112.688 32.84C112.688 31.1333 112.208 29.7867 111.248 28.8C110.314 27.8133 109.168 27.32 107.808 27.32C106.448 27.32 105.288 27.8133 104.328 28.8C103.394 29.76 102.928 31.0933 102.928 32.8C102.928 34.5067 103.394 35.8667 104.328 36.88C105.288 37.8667 106.448 38.36 107.808 38.36C109.168 38.36 110.314 37.8667 111.248 36.88C112.208 35.8933 112.688 34.5467 112.688 32.84ZM136.916 38.2V44H133.436C130.956 44 129.023 43.4 127.636 42.2C126.249 40.9733 125.556 38.9867 125.556 36.24V27.36H122.836V21.68H125.556V16.24H132.396V21.68H136.876V27.36H132.396V36.32C132.396 36.9867 132.556 37.4667 132.876 37.76C133.196 38.0533 133.729 38.2 134.476 38.2H136.916ZM139.566 29.92C139.566 27.1467 140.166 24.68 141.366 22.52C142.566 20.3333 144.233 18.64 146.366 17.44C148.526 16.2133 150.966 15.6 153.686 15.6C157.019 15.6 159.873 16.48 162.246 18.24C164.619 20 166.206 22.4 167.006 25.44H159.486C158.926 24.2667 158.126 23.3733 157.086 22.76C156.073 22.1467 154.913 21.84 153.606 21.84C151.499 21.84 149.793 22.5733 148.486 24.04C147.179 25.5067 146.526 27.4667 146.526 29.92C146.526 32.3733 147.179 34.3333 148.486 35.8C149.793 37.2667 151.499 38 153.606 38C154.913 38 156.073 37.6933 157.086 37.08C158.126 36.4667 158.926 35.5733 159.486 34.4H167.006C166.206 37.44 164.619 39.84 162.246 41.6C159.873 43.3333 157.019 44.2 153.686 44.2C150.966 44.2 148.526 43.6 146.366 42.4C144.233 41.1733 142.566 39.48 141.366 37.32C140.166 35.16 139.566 32.6933 139.566 29.92ZM169.835 32.8C169.835 30.5067 170.262 28.4933 171.115 26.76C171.995 25.0267 173.182 23.6933 174.675 22.76C176.168 21.8267 177.835 21.36 179.675 21.36C181.248 21.36 182.622 21.68 183.795 22.32C184.995 22.96 185.915 23.8 186.555 24.84V21.68H193.395V44H186.555V40.84C185.888 41.88 184.955 42.72 183.755 43.36C182.582 44 181.208 44.32 179.635 44.32C177.822 44.32 176.168 43.8533 174.675 42.92C173.182 41.96 171.995 40.6133 171.115 38.88C170.262 37.12 169.835 35.0933 169.835 32.8ZM186.555 32.84C186.555 31.1333 186.075 29.7867 185.115 28.8C184.182 27.8133 183.035 27.32 181.675 27.32C180.315 27.32 179.155 27.8133 178.195 28.8C177.262 29.76 176.795 31.0933 176.795 32.8C176.795 34.5067 177.262 35.8667 178.195 36.88C179.155 37.8667 180.315 38.36 181.675 38.36C183.035 38.36 184.182 37.8667 185.115 36.88C186.075 35.8933 186.555 34.5467 186.555 32.84ZM205.183 25.4C205.983 24.1733 206.983 23.2133 208.183 22.52C209.383 21.8 210.717 21.44 212.183 21.44V28.68H210.303C208.597 28.68 207.317 29.0533 206.463 29.8C205.61 30.52 205.183 31.8 205.183 33.64V44H198.343V21.68H205.183V25.4ZM236.493 32.48C236.493 33.12 236.453 33.7867 236.373 34.48H220.893C220.999 35.8667 221.439 36.9333 222.213 37.68C223.013 38.4 223.986 38.76 225.133 38.76C226.839 38.76 228.026 38.04 228.693 36.6H235.973C235.599 38.0667 234.919 39.3867 233.933 40.56C232.973 41.7333 231.759 42.6533 230.293 43.32C228.826 43.9867 227.186 44.32 225.373 44.32C223.186 44.32 221.239 43.8533 219.533 42.92C217.826 41.9867 216.493 40.6533 215.533 38.92C214.573 37.1867 214.093 35.16 214.093 32.84C214.093 30.52 214.559 28.4933 215.493 26.76C216.453 25.0267 217.786 23.6933 219.493 22.76C221.199 21.8267 223.159 21.36 225.373 21.36C227.533 21.36 229.453 21.8133 231.133 22.72C232.813 23.6267 234.119 24.92 235.053 26.6C236.013 28.28 236.493 30.24 236.493 32.48ZM229.493 30.68C229.493 29.5067 229.093 28.5733 228.293 27.88C227.493 27.1867 226.493 26.84 225.293 26.84C224.146 26.84 223.173 27.1733 222.373 27.84C221.599 28.5067 221.119 29.4533 220.933 30.68H229.493Z" fill="#F59245"/>
        </svg>
    </header>

    <div class="container text-center mb-5">
        <?php if (isset($user) && is_array($user)): ?>
            <?php
            $success = null;
            $error = null;
            if (isset($_GET['success'])) {
                if ($_GET['success'] === 'update_profile') {
                    $success = 'Profil berhasil diperbarui.';
                } elseif ($_GET['success'] === 'add') {
                    $success = 'Kucing berhasil ditambahkan.';
                } elseif ($_GET['success'] === 'update') {
                    $success = 'Kucing berhasil diperbarui.';
                } elseif ($_GET['success'] === 'delete') {
                    $success = 'Kucing berhasil dihapus.';
                }
            }
            if (isset($_GET['error'])) {
                if ($_GET['error'] === 'update_profile') {
                    $error = 'Gagal memperbarui profil.';
                } elseif ($_GET['error'] === 'add') {
                    $error = 'Gagal menambahkan kucing.';
                } elseif ($_GET['error'] === 'update') {
                    $error = 'Gagal memperbarui kucing.';
                } elseif ($_GET['error'] === 'delete') {
                    $error = 'Gagal menghapus kucing.';
                } elseif ($_GET['error'] === 'notfound') {
                    $error = 'Data tidak ditemukan.';
                } elseif ($_GET['error'] === 'database') {
                    $error = 'Kesalahan database. Silakan coba lagi.';
                }
            }
            ?>
            <?php if ($success): ?>
                <p class="success-message"><?php echo htmlspecialchars($success); ?></p>
            <?php endif; ?>
            <?php if ($error): ?>
                <p class="error-message"><?php echo htmlspecialchars($error); ?></p>
            <?php endif; ?>
            <img src="./images/<?= htmlspecialchars($user['profile_img']) ?>" class="profile-img" alt="Profil Pengguna" onerror="this.src='./images/defaultimage.png'">
            <h2 class="mt-3 text-custom"> <strong><?= htmlspecialchars($user['name']) ?></strong></h2>
            <p><?= htmlspecialchars($user['bio']) ?></p>
            <div class="position-relative">
                <a href="index.php?c=Profile&m=editProfile" class="btn btn-custom mb-3">Edit Profil</a>
                <a href="index.php?c=Profile&m=addKucing" class="btn btn-custom mb-3">Tambah Kucing</a>
            </div>
        <?php else: ?>
            <p>Data pengguna tidak tersedia.</p>
        <?php endif; ?>
    </div>

    <div class="container">
        <h3 class="text-custom mb-4">Daftar Kucing</h3>
        <div class="row">
            <?php if (isset($cats) && is_array($cats) && count($cats) > 0): ?>
                <?php foreach ($cats as $cat): ?>
                    <div class="col-md-4">
                        <a href="index.php?c=Profile&m=editKucing&id=<?php echo $cat['id_cat']; ?>" class="card-link">
                            <div id="kucing-0<?php echo $cat['id_cat']; ?>" class="card mx-auto mb-3" style="max-width: 300px;">
                                <div class="d-flex align-items-center p-3">
                                    <img src="./images/<?php echo htmlspecialchars($cat['cat_img']); ?>" class="profile-img me-3" alt="Kucing" style="width: 100px; height: 100px; object-fit: cover;" onerror="this.src='./images/defaultimage.png'">
                                    <div class="metadata">
                                        <p class="mb-1"><strong class="text-custom"><?php echo htmlspecialchars($cat['name']); ?></strong></p>
                                        <p class="mb-1"><?php echo htmlspecialchars($cat['breed']); ?></p>
                                        <p class="mb-1"><?php echo htmlspecialchars($cat['age']); ?> tahun</p>
                                        <p class="mb-0"><?php echo htmlspecialchars($cat['weight']); ?> kg</p>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                <?php endforeach; ?>
            <?php else: ?>
                <div class="col-12 text-center">
                    <p>Belum ada profil kucing.</p>
                </div>
            <?php endif; ?>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>